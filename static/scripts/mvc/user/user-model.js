define("mvc/user/user-model",["exports","libs/underscore","libs/backbone","mvc/base-mvc","utils/localization"],function(e,t,i,n,o){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}Object.defineProperty(e,"__esModule",{value:!0});r(t);var u=r(i),a=s(n),l=s(o),c=u.Model.extend(a.default.LoggableMixin).extend({_logNamespace:"user",urlRoot:function(){return Galaxy.root+"api/users"},defaults:{id:null,username:"("+(0,l.default)("anonymous user")+")",email:"",total_disk_usage:0,nice_total_disk_usage:"",quota_percent:null,is_admin:!1},initialize:function(e){this.log("User.initialize:",e),this.on("loaded",function(e,t){this.log(this+" has loaded:",e,t)}),this.on("change",function(e,t){this.log(this+" has changed:",e,t.changes)})},isAnonymous:function(){return!this.get("email")},isAdmin:function(){return this.get("is_admin")},loadFromApi:function(e,t){e=e||c.CURRENT_ID_STR;var i=this,n=(t=t||{}).success;return t.success=function(e,t){i.trigger("loaded",e,t),n&&n(e,t)},e===c.CURRENT_ID_STR&&(t.url=this.urlRoot+"/"+c.CURRENT_ID_STR),u.Model.prototype.fetch.call(this,t)},clearSessionStorage:function(){for(var e in sessionStorage)0===e.indexOf("history:")?sessionStorage.removeItem(e):"history-panel"===e&&sessionStorage.removeItem(e)},toString:function(){var e=[this.get("username")];return this.get("id")&&(e.unshift(this.get("id")),e.push(this.get("email"))),"User("+e.join(":")+")"}});c.CURRENT_ID_STR="current",c.getCurrentUserFromApi=function(e){var t=new c;return t.loadFromApi(c.CURRENT_ID_STR,e),t};u.Collection.extend(a.default.LoggableMixin).extend({model:c,urlRoot:function(){return Galaxy.root+"api/users"}});e.default={User:c}});