define("mvc/job/job-model",["exports","mvc/history/history-contents","mvc/dataset/states","utils/ajax-queue","mvc/base-mvc","utils/localization"],function(t,e,n,i,o,a){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(t,"__esModule",{value:!0});var u=s(e),r=s(n),l=s(i),c=s(o),d=(s(a),c.default.SearchableModelMixin),f=Backbone.Model.extend(c.default.LoggableMixin).extend(c.default.mixin(d,{_logNamespace:"jobs",defaults:{model_class:"Job",tool_id:null,exit_code:null,inputs:{},outputs:{},params:{},create_time:null,update_time:null,state:r.default.NEW},parse:function(t,e){return t.params=this.parseParams(t.params),t},parseParams:function(t){var e={};return _.each(t,function(t,n){e[n]=JSON.parse(t)}),e},initialize:function(t,e){this.debug(this+"(Job).initialize",t,e),this.set("params",this.parseParams(this.get("params")),{silent:!0}),this.outputCollection=t.outputCollection||new u.default.HistoryContents([]),this._setUpListeners()},_setUpListeners:function(){this.on("change:state",function(t,e){this.log(this+" has changed state:",t,e),this.inReadyState()&&this.trigger("state:ready",t,e,this.previous("state"))})},inReadyState:function(){return _.contains(r.default.READY_STATES,this.get("state"))},hasDetails:function(){return!_.isEmpty(this.get("outputs"))},urlRoot:Galaxy.root+"api/jobs",toString:function(){return["Job(",this.get("id"),":",this.get("tool_id"),")"].join("")}})),h=Backbone.Collection.extend(c.default.LoggableMixin).extend({_logNamespace:"jobs",model:f,urlRoot:Galaxy.root+"api/jobs",url:function(){return this.urlRoot},intialize:function(t,e){console.debug(t,e)},ids:function(){return this.map(function(t){return t.get("id")})},notReady:function(){return this.filter(function(t){return!t.inReadyState()})},haveDetails:function(){return this.all(function(t){return t.hasDetails()})},queueDetailFetching:function(){var t=this,e=new l.default.AjaxQueue(this.map(function(t){return function(){return t.fetch({silent:!0})}}));return e.done(function(){t.trigger("details-loaded")}),e},matches:function(t){return this.filter(function(e){return e.matches(t)})},toString:function(){return["JobCollection(",this.length,")"].join("")}},{fromHistory:function(t){console.debug(this);var e=new this([]);return e.fetch({data:{history_id:t}}).done(function(){window.queue=e.queueDetailFetching()}),e}});t.default={Job:f,JobCollection:h}});