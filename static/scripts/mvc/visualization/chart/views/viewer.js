define("mvc/visualization/chart/views/viewer",["exports","utils/utils"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(t);e.default=Backbone.View.extend({initialize:function(e,t){var a=this;this.app=e,this.chart=this.app.chart,this.options=t,this.setElement($("<div/>").addClass("charts-viewer").append($("<div/>").addClass("info").append($("<span/>").addClass("icon")).append($("<span/>").addClass("text")))),this.$info=this.$(".info"),this.$icon=this.$(".icon"),this.$text=this.$(".text"),this._fullscreen(this.$el,20),this._createContainer("div"),this.chart.on("redraw",function(e){a.chart.get("modified")&&a.chart.plugin.specs.confirm&&!e?a.chart.state("info","Please confirm the settings before rendering the results."):a.app.deferred.execute(function(e){console.debug("viewer:redraw() - Redrawing..."),a._draw(e,a.chart)})}),this.chart.on("set:state",function(){var e=a.$(".charts-viewer-container"),t=a.$info,i=a.$icon,s=a.$text;switch(i.removeClass(),t.show(),s.html(a.chart.get("state_info")),a.chart.get("state")){case"ok":t.hide(),e.show();break;case"failed":i.addClass("icon fa fa-warning"),e.hide();break;case"info":i.addClass("icon fa fa-info"),e.hide();break;default:i.addClass("icon fa fa-spinner fa-spin"),e.show()}})},_fullscreen:function(e,t){e.css("height",$(window).height()-t),$(window).resize(function(){e.css("height",$(window).height()-t)})},_createContainer:function(e,t){e=e||"div",t=t||1,this.$(".charts-viewer-container").remove(),this.targets=[];for(var i=0;i<t;i++){var s=a.default.uid(),n=$("<div/>").addClass("charts-viewer-container").width(parseInt(100/t)+"%").append($("<"+e+" class='charts-viewer-canvas' />").attr("id",s));this.$el.append(n),this.targets.push(s)}},_draw:function(e,t){var i="true"==t.settings.get("__use_panels")?t.groups.length:1;this._createContainer(t.plugin.specs.tag,i),t.set("date",a.default.time()),t.state("wait","Please wait..."),this.app.chart_load({process:e,chart:t,dataset:this.app.dataset,targets:this.targets})}})});