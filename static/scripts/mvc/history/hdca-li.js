define("mvc/history/hdca-li",["exports","mvc/dataset/states","mvc/collection/collection-li","mvc/collection/collection-view","mvc/base-mvc","mvc/history/history-item-li","utils/localization"],function(e,t,s,n,i,a,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(e,"__esModule",{value:!0});var l=r(t),c=r(s),d=r(n),p=(r(i),r(a)),u=r(o),m=c.default.DCListItemView,h=m.extend({className:m.prototype.className+" history-content",_setUpListeners:function(){var e=this;m.prototype._setUpListeners.call(this);var t=function(t,s){e.render()};this.model.jobStatesSummary&&this.listenTo(this.model.jobStatesSummary,"change",t),this.listenTo(this.model,{"change:tags change:visible change:state":t})},_getFoldoutPanelClass:function(){return d.default.CollectionView},_swapNewRender:function(e){m.prototype._swapNewRender.call(this,e);var t,s=this.model.jobStatesSummary;t=s?s.new()?"loading":s.errored()?"error":s.terminal()?"ok":s.running()?"running":"queued":this.model.get("job_source_id")?"loading":this.model.get("populated_state")?l.default.OK:l.default.RUNNING,this.$el.addClass("state-"+t);var n=this.stateDescription();return this.$(".state-description").html(n),this.$el},stateDescription:function(){var e=this.model,t=(e.get("element_count"),e.get("job_source_type")),s=(this.model.get("collection_type"),d.default.collectionTypeDescription(e)),n=d.default.collectionDescription(e),i=e.jobStatesSummary;if(t&&"Job"!=t){if(i&&i.hasDetails()){var a=i.new(),o=a?null:i.jobCount();if(a)return'\n                        <div class="progress state-progress">\n                            <span class="note">Creating jobs.<span class="blinking">..</span></span>\n                            <div class="progress-bar info" style="width:100%">\n                        </div>';if(i.errored())return"a "+s+" with "+i.numInError()+" / "+o+" jobs in error";if(i.terminal())return n;var r=i.states().running||0,l=(i.states().ok||0)/(1*o),c=r/(1*o),p=1-l-c;return'\n                        <div class="progress state-progress">\n                            <span class="note">'+(o&&o>1?o+" jobs":"a job")+" generating a "+s+'</span>\n                            <div class="progress-bar ok" style="width:'+100*l+'%"></div>\n                            <div class="progress-bar running" style="width:'+100*c+'%"></div>\n                            <div class="progress-bar new" style="width:'+100*p+'%">\n                        </div>'}return'\n                    <div class="progress state-progress">\n                        <span class="note">Loading job data for '+s+'.<span class="blinking">..</span></span>\n                        <div class="progress-bar info" style="width:100%">\n                    </div>'}return n},toString:function(){return"HDCAListItemView("+(this.model?""+this.model:"(no model)")+")"}});h.prototype.templates=function(){var e=_.extend({},m.prototype.templates.warnings,{hidden:function(e){e.visible||(0,u.default)("This collection has been hidden")}});return _.extend({},m.prototype.templates,{warnings:e,titleBar:function(e){return'\n        <div class="title-bar clear" tabindex="0">\n            <span class="state-icon"></span>\n            <div class="title">\n                <span class="hid">'+e.hid+'</span>\n                <span class="name">'+_.escape(e.name)+'</span>\n            </div>\n            <div class="state-description">\n            </div>\n            '+p.default.nametagTemplate(e)+"\n        </div>\n    "}})}(),e.default={HDCAListItemView:h}});