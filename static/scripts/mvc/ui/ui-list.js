define("mvc/ui/ui-list",["exports","utils/utils","mvc/ui/ui-portlet","mvc/ui/ui-misc"],function(t,i,e,s){"use strict";function l(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(t,"__esModule",{value:!0});var n=l(i),a=l(e),u=l(s),o=Backbone.View.extend({initialize:function(t){var i=this;this.options=t,this.name=t.name||"element",this.multiple=t.multiple||!1,this.message=new u.default.Message,this.portlet=new a.default.View({cls:"ui-portlet-section"}),this.select=new u.default.Select.View({optional:t.optional}),this.button=new u.default.ButtonIcon({icon:"fa fa-sign-in",tooltip:"Insert new "+this.name,onclick:function(){i.add({id:i.select.value(),name:i.select.text()})}}),this.setElement(this._template(t)),this.$(".ui-list-message").append(this.message.$el),this.$(".ui-list-portlet").append(this.portlet.$el),this.$(".ui-list-button").append(this.button.$el),this.$(".ui-list-select").append(this.select.$el)},value:function(t){if(void 0!==t){if(this.portlet.empty(),$.isArray(t))for(var i in t){var e=t[i],s=null,l=null;"string"!=$.type(e)?(s=e.id,l=e.name):s=l=e,null!=s&&this.add({id:s,name:l})}this._refresh()}var n=[];return this.$(".ui-list-id").each(function(){n.push({id:$(this).prop("id"),name:$(this).find(".ui-list-name").html()})}),0==n.length?null:n},add:function(t){var i=this;if(0===this.$('[id="'+t.id+'"]').length)if(n.default.isEmpty(t.id))this.message.update({message:"Please select a valid "+this.name+".",status:"danger"});else{var e=$(this._templateRow({id:t.id,name:t.name}));e.on("click",function(){e.remove(),i._refresh()}),e.on("mouseover",function(){e.addClass("portlet-highlight")}),e.on("mouseout",function(){e.removeClass("portlet-highlight")}),this.portlet.append(e),this._refresh()}else this.message.update({message:"This "+this.name+" is already in the list."})},update:function(t){this.select.update(t)},_refresh:function(){this.$(".ui-list-id").length>0?(!this.multiple&&this.button.disable(),this.$(".ui-list-portlet").show()):(this.button.enable(),this.$(".ui-list-portlet").hide()),this.options.onchange&&this.options.onchange()},_template:function(t){return'<div class="ui-list"><div class="ui-margin-top"><span class="ui-list-button"/><span class="ui-list-select"/></div><div class="ui-list-message"/><div class="ui-list-portlet"/></div>'},_templateRow:function(t){return'<div id="'+t.id+'" class="ui-list-id"><span class="ui-list-delete fa fa-trash"/><span class="ui-list-name">'+t.name+"</span></div>"}});t.default={View:o}});