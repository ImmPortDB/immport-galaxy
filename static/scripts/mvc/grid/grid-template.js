define("mvc/grid/grid-template",["exports","utils/utils","underscore"],function(t,e,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){return t&&t.__esModule?t:{default:t}}(e),n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}(a);t.default={grid:function(t){var e=void 0;return e=t.embedded?this.grid_header(t)+this.grid_table(t):'\n                <div class="loading-elt-overlay"></div>\n                <table class="grid-table">\n                    <tr>\n                        <td width="75%">'+this.grid_header(t)+'</td>\n                        <td></td>\n                        <td></td>\n                    </tr>\n                    <tr>\n                        <td width="100%" id="grid-message" valign="top"></td>\n                        <td></td>\n                        <td></td>\n                    </tr>\n                </table>\n                '+this.grid_table(t)+"\n            ",t.info_text&&(e+='<br><div class="toolParamHelp" style="clear: both;">'+t.info_text+"</div>"),e},grid_table:function(){return'\n            <form method="post" onsubmit="return false;">\n                <table id="grid-table" class="grid">\n                    <thead id="grid-table-header"></thead>\n                    <tbody id="grid-table-body"></tbody>\n                    <tfoot id="grid-table-footer"></tfoot>\n                </table>\n            </form>'},grid_header:function(t){var e='<div class="grid-header">';if(!t.embedded){var a="";t.title_id&&(a+=' id="'+t.title_id+'"'),e+="<h2"+a+">"+t.title+"</h2>"}if(t.global_actions){e+='<ul class="manage-table-actions">';var r=t.global_actions.length>=3;r&&(e+='<li><a class="action-button" id="popup-global-actions" class="menubutton">Actions</a></li><div popupmenu="popup-global-actions">');var n=!0,l=!1,i=void 0;try{for(var o,d=t.global_actions[Symbol.iterator]();!(n=(o=d.next()).done);n=!0){var s=o.value;e+='<li><a class="action-button use-target" target="'+s.target+'" href="'+s.url_args+'" onclick="return false;" >'+s.label+"</a></li>"}}catch(t){l=!0,i=t}finally{try{!n&&d.return&&d.return()}finally{if(l)throw i}}r&&(e+="</div>"),e+="</ul>"}return t.insert&&(e+=t.insert),e+=this.grid_filters(t),e+="</div>"},header:function(t){var e="<tr>";t.show_item_checkboxes&&(e+="<th>",t.items.length>0&&(e+='<input type="checkbox" id="check_all" name=select_all_checkbox value="true"><input type="hidden" name=select_all_checkbox value="true">'),e+="</th>");var a=!0,r=!1,n=void 0;try{for(var l,i=t.columns[Symbol.iterator]();!(a=(l=i.next()).done);a=!0){var o=l.value;o.visible&&(e+='<th id="'+o.key+'-header">',o.sortable?e+='<a href="javascript:void(0)" class="sort-link" sort_key="'+o.key+'">'+o.label+"</a>":e+=o.label,e+='<span class="sort-arrow">'+o.extra+"</span></th>")}}catch(t){r=!0,n=t}finally{try{!a&&i.return&&i.return()}finally{if(r)throw n}}return e+="</tr>"},body:function(t){var e="";0===t.items.length&&(e+='<tr><td colspan="100"><em>No Items</em></td></tr>');var a=!0,r=!1,n=void 0;try{for(var l,i=t.items[Symbol.iterator]();!(a=(l=i.next()).done);a=!0){var o=l.value;e+="<tr ",t.current_item_id==o.id&&(e+='class="current"'),e+=">",t.show_item_checkboxes&&(e+='<td style="width: 1.5em;"><input type="checkbox" name="id" value="'+o.encode_id+'" id="'+o.encode_id+'" class="grid-row-select-checkbox" /></td>');var d=!0,s=!1,c=void 0;try{for(var u,f=t.columns[Symbol.iterator]();!(d=(u=f.next()).done);d=!0){var p=u.value;if(p.visible){var v="";p.nowrap&&(v='style="white-space:nowrap;"');var g=o.column_config[p.label],b=g.link,h=g.value,y=g.target;"string"===$.type(h)&&(h=h.replace(/\/\//g,"/"));var _="";p.attach_popup&&(_="grid-"+o.encode_id+"-popup"),e+="<td "+v+">",p.delayed?e+='<div class="delayed-value-'+p.key+'" data-id="'+o.encode_id+'" data-value="'+h+'"><span class="fa fa-spinner fa-spin"></span></div>':p.attach_popup&&b?e+='<div class="btn-group">\n                                    <button class="btn btn-secondary use-target" target="'+y+'" href="'+b+'" onclick="return false;">'+h+'</button>\n                                    <button id="'+_+'" class="btn btn-secondary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown"/>\n                                </div>':p.attach_popup?e+='<button id="'+_+'" class="btn dropdown-toggle" data-toggle="dropdown">'+h+"</button>":e+=b?'<a class="use-target" target="'+y+'" href="'+b+'" onclick="return false;">'+h+"</a>":"<label>"+(h||"")+"</label>",e+="</td>"}}}catch(t){s=!0,c=t}finally{try{!d&&f.return&&f.return()}finally{if(s)throw c}}e+="</tr>"}}catch(t){r=!0,n=t}finally{try{!a&&i.return&&i.return()}finally{if(r)throw n}}return e},footer:function(t){var e="";if(t.use_paging&&t.num_pages>1){var a=t.num_page_links,r=t.cur_page_num,n=t.num_pages,l=a/2,i=r-l,o=0;i<=0&&(o=l-(r-(i=1)));var d,s=l+o,c=r+s;0!==(d=c<=n?0:s-((c=n)+1-r))&&(i-=d)<1&&(i=1),e+='<tr id="page-links-row">',t.show_item_checkboxes&&(e+="<td></td>"),e+='<td colspan="100"><span id="page-link-container">Page:',i>1&&(e+='<span class="page-link-grid" id="page-link-1"><a href="javascript:void(0);" page_num="1" onclick="return false;">1</a></span> ...');for(var u=i;u<c+1;u++)u==t.cur_page_num?e+='<span class="page-link-grid inactive-link" id="page-link-'+u+'">'+u+"</span>":e+='<span class="page-link-grid" id="page-link-'+u+'"><a href="javascript:void(0);" onclick="return false;" page_num="'+u+'">'+u+"</a></span>";c<n&&(e+='...<span class="page-link-grid" id="page-link-'+n+'"><a href="javascript:void(0);" onclick="return false;" page_num="'+n+'">'+n+"</a></span>"),e+="</span>",e+='\n                    <span class="page-link-grid" id="show-all-link-span"> | <a href="javascript:void(0);" onclick="return false;" page_num="all">Show All</a></span>\n                    </td>\n                </tr>'}if(t.show_item_checkboxes){e+='\n                <tr>\n                    <input type="hidden" id="operation" name="operation" value="">\n                    <td></td>\n                    <td colspan="100">\n                        For <span class="grid-selected-count"></span> selected items: \n            ';var f=!0,p=!1,v=void 0;try{for(var g,b=t.operations[Symbol.iterator]();!(f=(g=b.next()).done);f=!0){var h=g.value;h.allow_multiple&&(e+='<input type="button" value="'+h.label+'" class="operation-button action-button">&nbsp;')}}catch(t){p=!0,v=t}finally{try{!f&&b.return&&b.return()}finally{if(p)throw v}}e+="</td></tr>"}var y=!1,_=!0,m=!1,k=void 0;try{for(var x,w=t.operations[Symbol.iterator]();!(_=(x=w.next()).done);_=!0)if(x.value.global_operation){y=!0;break}}catch(t){m=!0,k=t}finally{try{!_&&w.return&&w.return()}finally{if(m)throw k}}if(y){e+='<tr><td colspan="100">';var S=!0,j=!1,A=void 0;try{for(var O,P=t.operations[Symbol.iterator]();!(S=(O=P.next()).done);S=!0){var C=O.value;C.global_operation&&(e+='<a class="action-button" href="'+C.global_operation+'">'+C.label+"</a>")}}catch(t){j=!0,A=t}finally{try{!S&&P.return&&P.return()}finally{if(j)throw A}}e+="</td></tr>"}return t.legend&&(e+='<tr><td colspan="100">'+t.legend+"</td></tr>"),e},message:function(t){var e=t.status;return-1!=["success","ok"].indexOf(e)&&(e="done"),'<p><div class="'+e+'message transient-message">'+n.escape(t.message)+'</div><div style="clear: both"></div></p>'},grid_filters:function(t){var e=t.default_filter_dict,a=t.filters,r="none";t.advanced_search&&(r="block");var n=!1,l=!0,i=!1,o=void 0;try{for(var d,s=t.columns[Symbol.iterator]();!(l=(d=s.next()).done);l=!0){var c=d.value;if("advanced"==c.filterable){var u=c.key,f=a[u],p=e[u];f&&p&&f!=p&&(r="block"),n=!0}}}catch(t){i=!0,o=t}finally{try{!l&&s.return&&s.return()}finally{if(i)throw o}}var v="block";"block"==r&&(v="none");var g='<div id="standard-search" style="display: '+v+';"><table><tr><td style="padding: 0;"><table>',b=!0,h=!1,y=void 0;try{for(var _,m=t.columns[Symbol.iterator]();!(b=(_=m.next()).done);b=!0){var k=_.value;"standard"==k.filterable&&(g+=this.grid_column_filter(t,k))}}catch(t){h=!0,y=t}finally{try{!b&&m.return&&m.return()}finally{if(h)throw y}}g+="</table></td></tr><tr><td>",n&&(g+='<a href="" class="advanced-search-toggle">Advanced Search</a>'),g+="</td></tr></table></div>",g+='<div id="advanced-search" style="display: '+r+'; margin-top: 5px; border: 1px solid #ccc;"><table><tr><td style="text-align: left" colspan="100"><a href="" class="advanced-search-toggle">Close Advanced Search</a></td></tr>';var x=!0,w=!1,S=void 0;try{for(var j,A=t.columns[Symbol.iterator]();!(x=(j=A.next()).done);x=!0){var O=j.value;"advanced"==O.filterable&&(g+=this.grid_column_filter(t,O))}}catch(t){w=!0,S=t}finally{try{!x&&A.return&&A.return()}finally{if(w)throw S}}return g+="</table></div>"},grid_column_filter:function(t,e){var a=t.filters,r=e.label,n=e.key;"advanced"==e.filterable&&(r=r.toLowerCase());var l="<tr>";if("advanced"==e.filterable&&(l+='<td align="left" style="padding-left: 10px">'+r+":</td>"),l+='<td style="padding-bottom: 1px;">',e.is_text){l+='<form class="text-filter-form" column_key="'+n+'" action="'+t.url+'" method="get" >';var i=!0,o=!1,d=void 0;try{for(var s,c=t.columns[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var u=s.value,f=a[u.key];f&&"All"!=f&&(u.is_text&&(f=JSON.stringify(f)),l+='<input type="hidden" id="'+u.key+'" name="f-'+u.key+'" value="'+f+'"/>')}}catch(t){o=!0,d=t}finally{try{!i&&c.return&&c.return()}finally{if(o)throw d}}l+='<span id="'+n+'-filtering-criteria">';var p=a[n];if(p){var v=$.type(p);if("string"==v&&"All"!=p&&(l+=this.filter_element(n,p)),"array"==v)for(var g in p){var b=p;b=b.slice(g),l+=this.filter_element(n,p[g])}}l+="</span>";var h="",y=20;"standard"==e.filterable&&((h=e.label.toLowerCase()).length<20&&(y=h.length),y+=4),l+='\n                <span class="search-box">\n                    <input class="search-box-input" id="input-'+n+'-filter" name="f-'+n+'" type="text" placeholder="'+h+'" size="'+y+'"/>\n                    <button type="submit" style="background: transparent; border: none; padding: 4px; margin: 0px;">\n                        <i class="fa fa-search"></i>\n                    </button>\n                </span>\n            </form>'}else{l+='<span id="'+n+'-filtering-criteria">';var _=!1;for(var m in t.categorical_filters[n]){var k=t.categorical_filters[n][m],x="",w="";for(var S in k)x=S,w=k[S];_&&(l+=" | "),_=!0;var j=a[n];j&&k[n]&&j==w?l+='<span class="categorical-filter '+n+'-filter current-filter">'+m+"</span>":l+='<span class="categorical-filter '+n+'-filter"><a href="javascript:void(0);" filter_key="'+x+'" filter_val="'+w+'">'+m+"</a></span>"}l+="</span>"}return l+="</td></tr>"},filter_element:function(t,e){return'<span class="text-filter-val">'+(e=r.default.sanitize(e))+'<a href="javascript:void(0);" filter_key="'+t+'" filter_val="'+e+'"><i class="fa fa-times" style="padding-left: 5px; padding-bottom: 6px;"/></a></span>'}}});