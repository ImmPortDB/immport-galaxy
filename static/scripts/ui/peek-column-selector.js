define("ui/peek-column-selector",[],function(){"use strict";function e(e){if(e.disabled&&"array"!==$.type(e.disabled))throw new Error('"disabled" must be defined as an array of indeces: '+JSON.stringify(e));if(e.multiselect&&e.selected&&"array"!==$.type(e.selected))throw new Error('Mulitselect rows need an array for "selected": '+JSON.stringify(e));if(!e.label||!e.id)throw new Error("Peek controls need a label and id for each control row: "+JSON.stringify(e));if(e.disabled&&-1!==e.disabled.indexOf(e.selected))throw new Error("Selected column is in the list of disabled columns: "+JSON.stringify(e));return e}function t(e,t){return $("<div/>").addClass(v).text(e.label)}function n(e,n){var a=$("<td/>").html(t(e,n)).attr("data-"+x,n);return e.disabled&&-1!==e.disabled.indexOf(n)&&a.addClass(C),a}function a(e,t,n){var a=e.children("."+v);e.hasClass(h)?a.html(void 0!==t.selectedText?t.selectedText:t.label):a.html(void 0!==t.unselectedText?t.unselectedText:t.label)}function r(e,t){var r=n(e,t);return e.selected===t&&r.addClass(h),a(r,e,t),r.hasClass(C)||r.click(function(n){var r=$(this);if(!r.hasClass(h)){r.parent().children("."+h).removeClass(h).each(function(){a($(this),e,t)}),r.addClass(h),a(r,e,t);var l={},d=r.parent().attr("id"),s=r.data(x);l[d]=s,r.parents(".peek").trigger(u,l)}}),r}function l(e,t){var r=n(e,t);return e.selected&&-1!==e.selected.indexOf(t)&&r.addClass(h),a(r,e,t),r.hasClass(C)||r.click(function(n){var r=$(this);r.toggleClass(h),a(r,e,t);var l=r.parent().find("."+h).map(function(e,t){return $(t).data(x)}),d={},s=r.parent().attr("id"),i=$.makeArray(l);d[s]=i,r.parents(".peek").trigger(u,d)}),r}function d(e,t){for(var n=[],a=0;a<e;a+=1)n.push(t.multiselect?l(t,a):r(t,a));return n}function s(e,t,n){var a=$("<tr/>").attr("id",t.id).addClass(m);if(n){var r=$("<td/>").addClass(p).text(t.label+":");a.append(r)}return a.append(d(e,t)),a}function i(t){t=$.extend(!0,{},o,t);var n=$(this).addClass(c).find("table"),a=n.find("th").length,r=n.find("tr").length,l=n.find("td[colspan]").map(function(e,n){var a=$(this);return a.text()&&a.text().match(new RegExp("^"+t.commentChar))?$(this).css("color","grey").parent().get(0):null});if(t.hideCommentRows&&(l.hide(),r-=l.length),t.includePrompts){var d=$("<th/>").addClass("top-left").text(t.topLeftContent).attr("rowspan",r);n.find("tr").first().prepend(d)}var i=n.find("th:not(.top-left)").each(function(e,n){var a=$(this),r=a.text().replace(/^\d+\.*/,""),l=t.columnNames[e]||r;a.attr("data-"+g,l).text(e+1+(l?"."+l:""))});return t.renameColumns&&i.addClass(b).click(function(){var e=$(this),n=e.index()+(t.includePrompts?0:1),a=e.data(g),r=window.prompt("New column name:",a);if(null!==r&&r!==a){e.text(n+(r?"."+r:"")).data(g,r).attr("data-",g,r);var l=$.makeArray(e.parent().children("th:not(.top-left)").map(function(){return $(this).data(g)}));e.parents(".peek").trigger(f,l)}}),t.controls.forEach(function(r,l){e(r);var d=s(a,r,t.includePrompts);n.find("tbody").append(d)}),this}var o={renameColumns:!1,columnNames:[],commentChar:"#",hideCommentRows:!1,includePrompts:!0,topLeftContent:"Columns:"},c="peek-column-selector",u="peek-column-selector.change",f="peek-column-selector.rename",m="control",p="control-prompt",h="selected",C="disabled",v="button",b="renamable-header",x="column-index",g="column-name";$.fn.extend({peekColumnSelector:function(e){return this.map(function(){return i.call(this,e)})}})});