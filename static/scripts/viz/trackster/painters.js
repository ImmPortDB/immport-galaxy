define("viz/trackster/painters",["exports","libs/underscore"],function(t,e){"use strict";function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){var a=t[0],i=t[1],r=e[0],n=e[1];return a<r?i<=r?u:i<=n?c:_:a>n?p:i<=n?v:d}function l(t,e){var a=n(t,e);return a!==u&&a!==p}function s(t,e,a,i,r,n){void 0===n&&(n=4);var l,s=i-e,o=r-a,h=Math.floor(Math.sqrt(s*s+o*o)/n),f=s/h,u=o/h;for(l=0;l<h;l++,e+=f,a+=u)l%2==0&&t.fillRect(e,a,n,1)}function o(t,e,a,i){var r=e-i/2,n=e+i/2,l=a-Math.sqrt(3*i/2);t.beginPath(),t.moveTo(r,l),t.lineTo(n,l),t.lineTo(e,a),t.lineTo(r,l),t.strokeStyle=this.fillStyle,t.fill(),t.stroke(),t.closePath()}Object.defineProperty(t,"__esModule",{value:!0});var h=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}(e),f=function(){function t(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,a,i){return a&&t(e.prototype,a),i&&t(e,i),e}}(),u=1001,_=1002,c=1003,d=1004,v=1005,p=1006,g=function(){function t(e){r(this,t),this.default_val=e||1}return f(t,[{key:"gen_val",value:function(t){return this.default_val}}]),t}(),m=function t(e){r(this,t),this.incomplete_features=e.incomplete_features,this.feature_mapper=e.feature_mapper},y=function(){function t(e,a,i,n,l){r(this,t),this.data=e,this.default_prefs={},this.view_start=a,this.view_end=i,this.prefs=h.extend({},this.default_prefs,n),this.mode=l}return f(t,[{key:"draw",value:function(t,e,a,i){}},{key:"get_start_draw_pos",value:function(t,e){return this._chrom_pos_to_draw_pos(t,e,-.5)}},{key:"get_end_draw_pos",value:function(t,e){return this._chrom_pos_to_draw_pos(t,e,.5)}},{key:"get_draw_pos",value:function(t,e){return this._chrom_pos_to_draw_pos(t,e,0)}},{key:"_chrom_pos_to_draw_pos",value:function(t,e,a){return Math.floor(e*(Math.max(0,t-this.view_start)+a))}}],[{key:"default_prefs",get:function(){return{}}}]),t}(),w=function(t){function e(t,i,n,l,s){return r(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n,l,s))}return i(e,y),f(e,[{key:"draw",value:function(t,e,a,i){var r=!1,n=this.prefs.min_value,l=this.prefs.max_value,s=l-n,o=a,f=this.view_start,u=this.mode,_=this.data;t.save();var c=Math.round(a+n/s*a);"Intensity"!==u&&(t.fillStyle="#aaa",t.fillRect(0,c,e,1)),t.beginPath();var d,v,p;p=_.length>1?h.map(_.slice(0,-1),function(t,e){return Math.ceil((_[e+1][0]-_[e][0])*i)}):[10];for(var g,m=this.prefs.block_color||this.prefs.color,y=parseInt(m.slice(1),16),w=(16711680&y)>>16,b=(65280&y)>>8,M=255&y,k=!1,x=!1,S=0,P=_.length;S<P;S++)if(t.fillStyle=t.strokeStyle=m,k=x=!1,g=p[S],d=Math.floor((_[S][0]-f-.5)*i),null!==(v=_[S][1])){if(v<n?(x=!0,v=n):v>l&&(k=!0,v=l),"Histogram"===u)v=Math.round(v/s*o),t.fillRect(d,c,g,-v);else if("Intensity"===u){var O=(v-n)/s,R=Math.round(w+(255-w)*(1-O)),T=Math.round(b+(255-b)*(1-O)),A=Math.round(M+(255-M)*(1-O));t.fillStyle="rgb("+R+","+T+","+A+")",t.fillRect(d,0,g,o)}else v=Math.round(o-(v-n)/s*o),r?t.lineTo(d,v):(r=!0,"Filled"===u?(t.moveTo(d,o),t.lineTo(d,v)):t.moveTo(d,v));if(t.fillStyle=this.prefs.overflow_color,k||x){var F;"Histogram"===u||"Intensity"===u?F=g:(d-=2,F=4),k&&t.fillRect(d,0,F,3),x&&t.fillRect(d,o-3,F,3)}t.fillStyle=m}else r&&"Filled"===u&&t.lineTo(d,o),r=!1;"Filled"===u?(r&&(t.lineTo(d,c),t.lineTo(0,c)),t.fill()):t.stroke(),t.restore()}}],[{key:"default_prefs",get:function(){return{min_value:void 0,max_value:void 0,mode:"Histogram",color:"#000",overflow_color:"#F66"}}}]),e}(),b=function(){function t(e){r(this,t),this.feature_positions={},this.slot_height=e,this.translation=0,this.y_translation=0}return f(t,[{key:"map_feature_data",value:function(t,e,a,i){this.feature_positions[e]||(this.feature_positions[e]=[]),this.feature_positions[e].push({data:t,x_start:a,x_end:i})}},{key:"get_feature_data",value:function(t,e){var a,i=Math.floor((e-this.y_translation)/this.slot_height);if(!this.feature_positions[i])return null;t+=this.translation;for(var r=0;r<this.feature_positions[i].length;r++)if(a=this.feature_positions[i][r],t>=a.x_start&&t<=a.x_end)return a.data}}]),t}(),M=function(t){function e(t,i,n,l,s,o,h){r(this,e);var f=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n,l,s));return f.alpha_scaler=o||new g,f.height_scaler=h||new g,f.max_label_length=200,f}return i(e,y),f(e,[{key:"get_required_height",value:function(t,e){var a=this.get_row_height(),i=a,r=this.mode;return"no_detail"!==r&&"Squish"!==r&&"Pack"!==r||(a=t*i),a+this.get_top_padding(e)}},{key:"get_top_padding",value:function(t){return 0}},{key:"draw",value:function(t,e,a,i,r){t.save(),t.fillStyle=this.prefs.block_color,t.textAlign="right";for(var n,l=this.get_row_height(),s=new b(l),o=[],h=0,f=this.data.length;h<f;h++){var u=this.data[h],_=u[0],c=u[1],d=u[2],v=r&&void 0!==r[_]?r[_].slot:null;("Dense"===this.mode||null!==v)&&c<this.view_end&&d>this.view_start&&(n=this.draw_element(t,this.mode,u,v,this.view_start,this.view_end,i,l,e),s.map_feature_data(u,v,n[0],n[1]),(c<this.view_start||d>this.view_end)&&o.push(u))}return t.restore(),s.y_translation=this.get_top_padding(e),new m({incomplete_features:o,feature_mapper:s})}},{key:"draw_element",value:function(t,e,a,i,r,n,l,s,o){return[0,0]}}],[{key:"default_prefs",get:function(){return{block_color:"#FFF",connector_color:"#FFF"}}}]),e}(),k=function(t){function e(t,i,n,l,s,o,h){r(this,e);var f=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n,l,s,o,h));return f.draw_background_connector=!0,f.draw_individual_connectors=!1,f}return i(e,M),f(e,[{key:"get_row_height",value:function(){var t=this.mode;return"Dense"===t?10:"no_detail"===t?3:"Squish"===t?5:10}},{key:"draw_element",value:function(t,e,a,i,r,n,l,s,o){var h=a[1],f=a[2],u=a[3],_=a[4],c=Math.floor(Math.max(0,(h-r-.5)*l)),d=Math.ceil(Math.min(o,Math.max(0,(f-r-.5)*l))),v=c,p=d,g=("Dense"===e?0:0+i)*s+this.get_top_padding(o),m=null,y=null,w=_&&"+"!==_&&"."!==_?this.prefs.reverse_strand_color:this.prefs.block_color,b=this.prefs.label_color;if(t.globalAlpha=this.alpha_scaler.gen_val(a),"Dense"===e&&(i=1),"no_detail"===e)t.fillStyle=w,t.fillRect(c,g+5,d-c,1);else{var M=a[5],k=a[6],x=a[7],S=!0;M&&k&&(m=Math.floor(Math.max(0,(M-r)*l)),y=Math.ceil(Math.min(o,Math.max(0,(k-r)*l))));var P,O;if("Squish"===e?(P=1,O=3,S=!1):(P=5,O=9),x){var R,T;"Squish"===e||"Dense"===e?(R=g+Math.floor(1.5)+1,T=1):_?(R=g,T=O):(R+=2.5,T=1),this.draw_background_connector&&("Squish"===e||"Dense"===e?t.fillStyle="#ccc":_?"+"===_?t.fillStyle=t.canvas.manager.get_pattern("right_strand"):"-"===_&&(t.fillStyle=t.canvas.manager.get_pattern("left_strand")):t.fillStyle="#ccc",t.fillRect(c,R,d-c,T));for(var A=0,F=x.length;A<F;A++){var I,j,q=x[A],D=Math.floor(Math.max(0,(q[0]-r-.5)*l)),H=Math.ceil(Math.min(o,Math.max((q[1]-r-.5)*l)));if(!(D>H)){if(t.fillStyle=w,t.fillRect(D,g+(O-P)/2+1,H-D,P),void 0!==m&&k>M&&!(D>y||H<m)){var X=Math.max(D,m),L=Math.min(H,y);t.fillRect(X,g+1,L-X,O),1===x.length&&"Pack"===e&&("+"===_?t.fillStyle=t.canvas.manager.get_pattern("right_strand_inv"):"-"===_&&(t.fillStyle=t.canvas.manager.get_pattern("left_strand_inv")),X+14<L&&(X+=2,L-=2),t.fillRect(X,g+1,L-X,O))}this.draw_individual_connectors&&I&&this.draw_connector(t,I,j,D,H,g),I=D,j=H}}if("Pack"===e){t.globalAlpha=1,t.fillStyle="white";var N=this.height_scaler.gen_val(a),C=Math.ceil(O*N),E=Math.round((O-C)/2);1!==N&&(t.fillRect(c,R+1,d-c,E),t.fillRect(c,R+O-E+1,d-c,E))}}else t.fillStyle=w,t.fillRect(c,g+1,d-c,O),_&&S&&("+"===_?t.fillStyle=t.canvas.manager.get_pattern("right_strand_inv"):"-"===_&&(t.fillStyle=t.canvas.manager.get_pattern("left_strand_inv")),t.fillRect(c,g+1,d-c,O));t.globalAlpha=1,u&&"Pack"===e&&h>r&&(t.fillStyle=b,0===r&&c-t.measureText(u).width<0?(t.textAlign="left",t.fillText(u,d+2,g+8,this.max_label_length),p+=t.measureText(u).width+2):(t.textAlign="right",t.fillText(u,c-2,g+8,this.max_label_length),v-=t.measureText(u).width+2))}return t.globalAlpha=1,[v,p]}}]),e}(),x=function(t){function e(t,i,n,l,s,o,h,f,u){r(this,e);var _=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n,l,s,o,h));return _.ref_seq=f?f.data:null,_.base_color_fn=u,_}return i(e,M),f(e,[{key:"get_row_height",value:function(){var t,e=this.mode;return"Dense"===e?t=10:"Squish"===e?t=5:(t=10,this.prefs.show_insertions&&(t*=2)),t}},{key:"_parse_cigar",value:function(t){var e=[[0,0]],a=e[0],i=0,r=h.map(t.match(/[0-9]+[MIDNSHP=X]/g),function(t){var r=parseInt(t.slice(0,-1),10),n=t.slice(-1);return"N"===n?0!==a[1]&&(a=[i+r,i+r],e.push(a)):-1==="ISHP".indexOf(n)&&(a[1]+=r,i+=r),["MIDNSHP=X".indexOf(n),r]});return{blocks:e,cigar:r}}},{key:"draw_read",value:function(t,e,a,i,r,s,h,f,u,p){var g=function(t){return Math.floor(Math.max(0,(t-r-.5)*a))};t.textAlign="center";var m,y,w=[r,s],b=0,M=0,k=Math.round(a/2),x=t.canvas.manager.char_width_px,S="+"===u?this.prefs.detail_block_color:this.prefs.reverse_strand_color,P="Pack"===e,O=P?9:3,R=i+1,T=new A(t,O,a,e),F=[],I=[],j=this._parse_cigar(f);f=j.cigar,F=j.blocks;for(var q=0;q<F.length;q++){var D=F[q];l([h+D[0],h+D[1]],w)&&((m=g(h+D[0]))===(y=g(h+D[1]))&&(y+=1),t.fillStyle=S,t.fillRect(m,R,y-m,O))}for(var H=0,X=f.length;H<X;H++){var L=f[H],N="MIDNSHP=X"[L[0]],C=L[1],E=h+b;if(m=g(E),y=g(E+C),l([E,E+C],w))switch(m===y&&(y+=1),N){case"H":case"S":case"P":break;case"M":b+=C;break;case"=":case"X":var z="";"X"===N?z=p.slice(M,M+C):this.ref_seq&&(z=this.ref_seq.slice(Math.max(0,E-r),Math.min(E-r+C,s-r)));for(var B=Math.max(E,r),G=0;G<z.length;G++)if(z&&!this.prefs.show_differences||"X"===N){var V=Math.floor(Math.max(0,(B+G-r)*a));t.fillStyle=this.base_color_fn(z[G]),P&&a>x?t.fillText(z[G],V,i+9):a>.05&&t.fillRect(V-k,R,Math.max(1,Math.round(a)),O)}"X"===N&&(M+=C),b+=C;break;case"N":t.fillStyle="#ccc",t.fillRect(m,R+(O-1)/2,y-m,1),b+=C;break;case"D":T.draw_deletion(m,R,C),b+=C;break;case"I":var J=m-k;if(l([E,E+C],w)){var K=p.slice(M,M+C);if(this.prefs.show_insertions){var Q=m-(y-m)/2;if(("Pack"===e||"Auto"===this.mode)&&void 0!==p&&a>x){switch(t.fillStyle="yellow",t.fillRect(Q-k,i-9,y-m,9),I[I.length]={type:"triangle",data:[J,i+4,5]},t.fillStyle="#ccc",n([E,E+C],w)){case c:K=K.slice(r-E);break;case d:K=K.slice(0,E-s);break;case v:break;case _:K=K.slice(r-E,E-s)}for(var U=0,W=K.length;U<W;U++){var Y=Math.floor(Math.max(0,(E+U-r)*a));t.fillText(K[U],Y-(y-m)/2,i)}}else t.fillStyle="yellow",t.fillRect(Q,i+("Dense"!==this.mode?2:5),y-m,"Dense"!==e?3:9)}else("Pack"===e||"Auto"===this.mode)&&void 0!==p&&a>x&&I.push({type:"text",data:[K.length,J,i+9]})}M+=C}else b=function(t,e,a){return-1!=="M=NXD".indexOf(e)&&(t+=a),t}(b,N,C),M=function(t,e,a){return-1!=="IX".indexOf(e)&&(t+=a),t}(M,N,C)}t.fillStyle="yellow";for(var Z,$,tt,et=0;et<I.length;et++)$=(Z=I[et]).type,tt=Z.data,"text"===$?(t.save(),t.font="bold "+t.font,t.fillText(tt[0],tt[1],tt[2]),t.restore()):"triangle"===$&&o(t,tt[0],tt[1],tt[2])}},{key:"draw_element",value:function(t,e,a,i,r,n,l,o,h){var f=a[1],u=a[2],_=a[3],c=Math.floor(Math.max(-.5*l,(f-r-.5)*l)),d=Math.ceil(Math.min(h,Math.max(0,(u-r-.5)*l))),v=("Dense"===e?0:0+i)*o,p="Pack"===e?9:3;if(a[5]instanceof Array){var g=!0;a[4][1]>=r&&a[4][0]<=n&&a[4][2]?this.draw_read(t,e,l,v,r,n,a[4][0],a[4][2],a[4][3],a[4][4]):g=!1,a[5][1]>=r&&a[5][0]<=n&&a[5][2]?this.draw_read(t,e,l,v,r,n,a[5][0],a[5][2],a[5][3],a[5][4]):g=!1;var m=Math.ceil(Math.min(h,Math.max(-.5*l,(a[4][1]-r-.5)*l))),y=Math.floor(Math.max(-.5*l,(a[5][0]-r-.5)*l));if(g&&y>m){t.fillStyle="#ccc";var w=v+1+(p-1)/2;s(t,m,w,y,w)}}else this.draw_read(t,e,l,v,r,n,f,a[4],a[5],a[6]);return"Pack"===e&&f>=r&&"."!==_&&(t.fillStyle=this.prefs.label_color,0===r&&c-t.measureText(_).width<0?(t.textAlign="left",t.fillText(_,d+2,v+9,this.max_label_length)):(t.textAlign="right",t.fillText(_,c-2,v+9,this.max_label_length))),[0,0]}}]),e}(),S=function(t){function e(t,i,n,l,s,o,h){r(this,e);var f=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n,l,s,o,h));return f.longest_feature_length=f.calculate_longest_feature_length(),f.draw_background_connector=!1,f.draw_individual_connectors=!0,f}return i(e,k),f(e,[{key:"calculate_longest_feature_length",value:function(){for(var t=0,e=0,a=this.data.length;e<a;e++){var i=this.data[e],r=i[1],n=i[2];t=Math.max(t,n-r)}return t}},{key:"get_top_padding",value:function(t){var e=t/(this.view_end-this.view_start);return Math.min(128,Math.ceil(this.longest_feature_length/2*e))}},{key:"draw_connector",value:function(t,e,a,i,r,n){var l=(a+i)/2;i-l>0&&(t.beginPath(),t.arc(l,n,i-l,Math.PI,0),t.stroke())}}]),e}(),P=function(){function t(e,a){r(this,t),Array.isArray(e)?this.rgb=e:6==e.length?this.rgb=e.match(/.{2}/g).map(function(t){return parseInt(t,16)}):7==e.length?this.rgb=e.substring(1,7).match(/.{2}/g).map(function(t){return parseInt(t,16)}):this.rgb=e.split("").map(function(t){return parseInt(t+t,16)}),this.alpha="number"==typeof a?a:1}return f(t,[{key:"eval",value:function(){return this}},{key:"toCSS",value:function(){return this.alpha<1?"rgba("+this.rgb.map(function(t){return Math.round(t)}).concat(this.alpha).join(", ")+")":"#"+this.rgb.map(function(t){return t=Math.round(t),1===(t=(t>255?255:t<0?0:t).toString(16)).length?"0"+t:t}).join("")}},{key:"toHSL",value:function(){var t,e,a=this.rgb[0]/255,i=this.rgb[1]/255,r=this.rgb[2]/255,n=this.alpha,l=Math.max(a,i,r),s=Math.min(a,i,r),o=(l+s)/2,h=l-s;if(l===s)t=e=0;else{switch(e=o>.5?h/(2-l-s):h/(l+s),l){case a:t=(i-r)/h+(i<r?6:0);break;case i:t=(r-a)/h+2;break;case r:t=(a-i)/h+4}t/=6}return{h:360*t,s:e,l:o,a:n}}},{key:"toARGB",value:function(){return"#"+[Math.round(255*this.alpha)].concat(this.rgb).map(function(t){return t=Math.round(t),1===(t=(t>255?255:t<0?0:t).toString(16)).length?"0"+t:t}).join("")}},{key:"mix",value:function(e,a){var i=this,r=a,n=2*r-1,l=i.toHSL().a-e.toHSL().a,s=((n*l==-1?n:(n+l)/(1+n*l))+1)/2,o=1-s;return new t([i.rgb[0]*s+e.rgb[0]*o,i.rgb[1]*s+e.rgb[1]*o,i.rgb[2]*s+e.rgb[2]*o],i.alpha*r+e.alpha*(1-r))}}]),t}(),O=function(){function t(e,a,i,n){r(this,t),this.start_color=new P(e),this.end_color=new P(a),this.start_value=i,this.end_value=n,this.value_range=n-i}return f(t,[{key:"map_value",value:function(t){return t=Math.max(t,this.start_value),t=Math.min(t,this.end_value),t=(t-this.start_value)/this.value_range,this.start_color.mix(this.end_color,1-t).toCSS()}}]),t}(),R=function(){function t(e,a,i,n,l){r(this,t),this.positive_ramp=new O(a,i,0,l),this.negative_ramp=new O(a,e,0,-n),this.start_value=n,this.end_value=l}return f(t,[{key:"map_value",value:function(t){return t=Math.max(t,this.start_value),(t=Math.min(t,this.end_value))>=0?this.positive_ramp.map_value(t):this.negative_ramp.map_value(-t)}}]),t}(),T=function(t){function e(t,i,n,l,s){r(this,e);var o,h,f=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n,l,s));if(void 0===f.prefs.min_value){var u=1/0;for(o=0,h=f.data.length;o<h;o++)u=Math.min(u,f.data[o][6]);f.prefs.min_value=u}if(void 0===f.prefs.max_value){var _=-1/0;for(o=0,h=f.data.length;o<h;o++)_=Math.max(_,f.data[o][6]);f.prefs.max_value=_}return f}return i(e,y),f(e,[{key:"draw",value:function(t,e,a,i){var r,n,l,s,o,h,f=this.prefs.min_value,u=this.prefs.max_value,_=this.view_start,c=1/Math.sqrt(2),d=new R(this.prefs.neg_color,"#FFFFFF",this.prefs.pos_color,f,u),v=function(t){return(t-_)*i};t.save(),t.rotate(-45*Math.PI/180),t.scale(c,c);for(var p=0,g=this.data.length;p<g;p++)n=v((r=this.data[p])[1]),l=v(r[2]),s=v(r[4]),o=v(r[5]),h=r[6],t.fillStyle=d.map_value(h),t.fillRect(n,s,l-n,o-s);t.restore()}}],[{key:"default_prefs",get:function(){return{min_value:void 0,max_value:void 0,mode:"Heatmap",pos_color:"#FF8C00",neg_color:"#4169E1"}}}]),e}(),A=function(){function t(e,a,i,n){r(this,t),this.ctx=e,this.row_height=a,this.px_per_base=i,this.draw_details=("Pack"===n||"Auto"===n)&&i>=e.canvas.manager.char_width_px,this.delete_details_thickness=.2}return f(t,[{key:"draw_deletion",value:function(t,e,a){this.ctx.fillStyle="black";var i=(this.draw_details?this.delete_details_thickness:1)*this.row_height;e+=.5*(this.row_height-i),this.ctx.fillRect(t,e,a*this.px_per_base,i)}}]),t}(),F=function(t){function e(t,i,n,l,s,o){r(this,e);var h=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n,l,s));return h.base_color_fn=o,h.divider_height=1,h}return i(e,y),f(e,[{key:"get_row_height",value:function(){var t=this.mode;return"Dense"===t?10:"Squish"===t?5:10}},{key:"get_required_height",value:function(t){var e=this.prefs.summary_height;return t>1&&this.prefs.show_sample_data&&(e+=this.divider_height+t*this.get_row_height()),e}},{key:"draw",value:function(t,e,a,i){t.save();var r,n,l,s,o,f,u,_,c,d,v,p=function(t,e){var a=t.length,i=e.length,r=0,n=1,l=null;return"-"===e?(l="deletion",n=t.length):0===t.indexOf(e)&&a>i?(l="deletion",n=a-i,r=i):0===e.indexOf(t)&&a<i&&(l="insertion",n=i-a,r=i),null!==l?{type:l,start:r,len:n}:{}},g=Math.max(1,Math.floor(i)),m=this.data.length?this.data[0][7].split(",").length:0,y="Squish"===this.mode?5:10,w=i<.1?y:"Squish"===this.mode?3:9,b=!0,M=new A(t,y,i,this.mode);1===m&&(y=w=i<t.canvas.manager.char_width_px?this.prefs.summary_height:y,M.row_height=y,b=!1),this.prefs.show_sample_data&&b&&(t.fillStyle="#F3F3F3",t.globalAlpha=1,t.fillRect(0,this.prefs.summary_height-this.divider_height,e,this.divider_height)),t.textAlign="center";for(var k=0;k<this.data.length;k++)if(r=this.data[k],n=r[1],l=r[3],s=[r[4].split(",")],o=r[7].split(","),f=r.slice(8),s=h.map(h.flatten(s),function(t){var e={type:"snp",value:t,start:0},a=p(l,t);return h.extend(e,a)}),!(n<this.view_start||n>this.view_end)){if(b)for(t.fillStyle="#999999",t.globalAlpha=1,v=0;v<s.length;v++)for(_=this.get_start_draw_pos(n+s[v].start,i),t.fillRect(_,0,g,this.prefs.summary_height),c=this.prefs.summary_height,v=0;v<s.length;v++){t.fillStyle="deletion"===s[v].type?"black":this.base_color_fn(s[v].value);var x=f/o.length,S=Math.ceil(this.prefs.summary_height*x);t.fillRect(_,c-S,g,S),c-=S}if(this.prefs.show_sample_data)for(c=b?this.prefs.summary_height+this.divider_height:0,v=0;v<o.length;v++,c+=y)if(d=o[v]?o[v].split(/\/|\|/):["0","0"],u=null,d[0]===d[1]?"."===d[0]||"0"!==d[0]&&(u=s[parseInt(d[0],10)-1],t.globalAlpha=1):(u="0"!==d[0]?d[0]:d[1],u=s[parseInt(u,10)-1],t.globalAlpha=.5),u)if(_=this.get_start_draw_pos(n+u.start,i),"snp"===u.type){var P=u.value;t.fillStyle=this.base_color_fn(P),M.draw_details?t.fillText(P,this.get_draw_pos(n,i),c+y):t.fillRect(_,c+1,g,w)}else"deletion"===u.type&&M.draw_deletion(_,c+1,u.len)}t.restore()}}]),e}();t.default={Scaler:g,LinePainter:w,LinkedFeaturePainter:k,ReadPainter:x,ArcLinkedFeaturePainter:S,DiagonalHeatmapPainter:T,VariantPainter:F}});