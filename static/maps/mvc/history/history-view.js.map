{"version":3,"file":"history-view.js","sources":["../../../src/mvc/history/history-view.js"],"names":["define","LIST_VIEW","HISTORY_MODEL","HISTORY_CONTENTS","HDA_LI","HDCA_LI","USER","faIconButton","PopupMenu","BASE_MVC","_l","logNamespace","HistoryPrefs","SessionStorageModel","extend","defaults","expandedIds","show_deleted","show_hidden","addExpanded","model","key","this","save","_","get","object","id","removeExpanded","omit","toString","storageKeyPrefix","historyStorageKey","historyId","Error","clearAll","sessionStorage","indexOf","removeItem","_super","ModelListPanel","HistoryView","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","linkTarget","freeModel","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","loadHistoryWithDetails","historyFn","contentsFn","info","detailIdsFn","historyData","values","loadHistory","FETCH_COLLECTION_COUNTS_DELAY","panel","History","getHistoryData","initiallyExpanded","_loadHistoryFromXHR","fail","where","history","done","delay","contents","fetchCollectionCounts","always","then","historyJSON","contentsJSON","JSONToModel","render","refreshContents","refresh","$","when","newHistoryJSON","newHdaJSON","log","setModel","_setUpWebStorage","storage","stopListening","isObject","set","isBoolean","listenTo","change:show_deleted","view","newVal","showDeleted","change:show_hidden","showHidden","undefined","_buildNewRender","$newRender","$where","$el","multiselectActions","hideSelectors","find","remove","$existing","title","classes","faIcon","prependTo","_getItemViewClass","contentType","TypeError","_filterItem","hidden","isDeletedOrPurged","_getItemViewOptions","expanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","v","collapsed","getSelectedModels","collection","events","clone","click .show-selectors-btn","click .messages [class$=message]","toggleShowDeleted","show","store","renderItems","toggleShowHidden","_firstSearch","searchFor","inputSelector","haveDetails","searchItems","searchInput","fetchAllDetails","silent","status","readyState","parsed","_parseErrorMessage","$messages","is","displayMessage","message","once","user","Galaxy","_bePolite","raven","window","Raven","isFunction","lastEventId","agent","navigator","userAgent","url","lastAjax","data","source","toJSON","User","getAllResponseHeaders","responseHeaders","compact","split","map","header","type","scrollToTop","$msgContainer","$msg","addClass","html","isEmpty","$detailsLink","click","modal","_messageToModalOptions","append","functions","text","JSON","stringify","pre","body","buttons","Ok","hide","clearMessages","ev","$target","isUndefined","children","currentTarget","fadeOut","fxSpeed","scrollToHid","hid","scrollToItem","first","viewsWhereModel","templates","controlsTemplate","wrapTemplate","controls"],"mappings":"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"}