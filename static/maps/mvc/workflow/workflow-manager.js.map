{"version":3,"file":"workflow-manager.js","sources":["../../../src/mvc/workflow/workflow-manager.js"],"names":["define","Connector","Toastr","Workflow","app","canvas_container","this","id_counter","nodes","name","has_changes","active_form_has_changes","nodeLabels","workflowOutputLabels","$","extend","prototype","canLabelNodeWith","label","registerNodeLabel","unregisterNodeLabel","updateNodeLabel","fromLabel","toLabel","warning","attemptUpdateNodeLabel","node","setLabel","canLabelOutputWith","registerOutputLabel","unregisterOutputLabel","updateOutputLabel","attemptUpdateOutputLabel","outputName","labelWorkflowOutput","nodeView","redrawWorkflowOutputs","create_node","type","title_text","content_id","prebuildNode","add_node","fit_canvas_to_nodes","canvas_manager","draw_overview","activate_node","id","element","attr","workflow","remove_node","active_node","clear_active_node","remove_all","wf","each","k","v","destroy","rectify_workflow_outputs","using_workflow_outputs","has_existing_pjas","workflow_outputs","length","post_job_actions","pja_id","pja","action_type","self","node_changed","pjas_to_rem","push","i","pja_name","output_terminals","ot_id","ot","create_pja","isWorkflowOutput","output_name","action_arguments","reload_active_node","to_simple","input_connections","input_terminals","t","cons","connectors","c","con_dict","handle1","input_subworkflow_step_id","attributes","input","undefined","act","node_data","tool_state","tool_errors","position","annotation","uuid","steps","from_simple","data","initialImport_","initialImport","offset","Object","keys","max_id","step","workflow_output","init_field_data","css","top","left","parseInt","Math","max","isArray","l","x","other_node","connect","redraw","addWorkflowOutput","callout","find","Galaxy","root","check_changes_in_active_form","submit","make_inactive","showToolForm","form_html","make_active","force","layout","n_pred","successors","j","other","node_ids_by_level","level_parents","pred_k","sk","all_nodes","h_pad","v_pad","ids","sort","a","b","max_width","width","height","_","bounds_for_all_nodes","p","xmin","xmax","ymin","ymax","e","min","round_up","n","ceil","fix_delta","new_pos","bounds","parent","xmin_delta","ymin_delta","children"],"mappings":"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"}