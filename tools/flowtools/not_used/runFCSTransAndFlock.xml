<tool id="runFCSTransAndFlock" name="Run FCSTrans and FLOCK" version="1.0">
  <description>serially</description>
  <command interpreter="python">
    runFCSTransAndFlock.py -i $input -c $compensate -f "$output_1" -o "$output_2" -m $method -t $__tool_directory__
    #if $bins
      -b $bins
    #end if
    #if $density
      -d $density
    #end if
  </command>

  <inputs>
    <param format="fcs" name="input" type="data" label="FCS File"/>
    <param name="compensate" type="boolean" checked="false" truevalue="TRUE" falsevalue="FALSE" label="Compensate?">
    </param>
    <param name="method" type="select" label="Method">
        <option value="flock1" selected="true">Flock Version 1</option>
        <option value="flock2">Flock Version 2</option>
    </param>
    <param name="bins" type="integer" min="6" max="30" optional="true" value="" label="bins (6-30)"/>
    <param name="density" type="integer" min="2" max="100" optional="true" value="" label="density (2-100)"/>
  </inputs>

  <outputs>
    <data format="flowtext" name="output_1" label="FCSTrans on ${input.name}"/>
    <data format="flowclr" name="output_2" label="${method} on FCSTrans on ${input.name}"/>
  </outputs>
   
 <help>
   This tool runs FCSTrans followed by FLOCK.
   
-----

FLOCK (FLOw Clustering without K) is a computational approach to flow cytometry analysis which:

 - Computationally determines the number of unique populations in high dimensional flow data using a rapid binning approach
 - Can handle non-spherical hyper-shapes
 - Maps populations across independent samples
 - Calculates many useful summary statistics
 - Finds the most informative parameters
 - Reduces subjective factors in manual gating

**Input**

FCSTrans reads in a FCS file, transforms the data and generates a text file. This text file is read in by FLOCK.
In order to define the populations in a given dataset collection for a given set of markers, run FLOCK on a super-set of FCS file. You can use one of the merge tools to concatenate and/or downsample datasets, and remove, edit or rearrange markers before running FLOCK on your favorite set of markers.

**Output** 

FLOCK attributes each event to a population and generates a text file.

-----

**Example**

*Input*::

   Marker1 Marker2 Marker3
   34      45      12
   33      65      10
   19      62      98
   12      36      58

*Output*::

   Marker1 Marker2 Marker3 Population
   34      45      12      1
   33      65      10      5
   19      62      98      2
   12      36      58      1

-----

**Reference**
FCSTrans: An open source software system for FCS file conversion and data transformation Qian Y, Liu Y, Campbell J, Thomson E, Kong YM, Scheuermann RH. 2012 Cytometry Part A. 81A(5) doi.org/10.1002/cyto.a.22037
 
Elucidation of seventeen human peripheral blood B-cell subsets and quantification of the tetanus response using a density-based method for the automated identification of cell populations in multidimensional flow cytometry data Qian Y, Wei C, Eun-Hyung Lee F, Campbell J, Halliley J, Lee JA, Cai J, Kong YM, Sadat E, Thomson E, Dunn P, Seegmiller AC, Karandikar NJ, Tipton CM, Mosmann T, Sanz I, Scheuermann RH. Cytometry B Clin Cytom. 2010;78 Suppl 1:S69-82.
 </help>
</tool>
