<tool id="get_profiles_cell_ontology" name="Associate FLOCK populations" version="1.0">
  <description>with cell ontology</description>
  <requirements>
    <requirement type="package" version="2.8">jinja2</requirement>
    <requirement type="package" version="3.2.3">r</requirement>
    <requirement type="package" version="1.10.0">bioconductor-flowcl</requirement>
  </requirements>
  <stdio>
    <exit_code range="2" level="fatal" description="There was a problem running flowCL. You might want to check your marker names - See stderr for more details." />
    <exit_code range="3:" level="fatal" description="See stderr for more details." />
  </stdio>
  <command><![CDATA[
    python $__tool_directory__/profileCLs.py -i "${input}" -o "${html_file}" -d "${html_file.files_path}" -t $__tool_directory__
  ]]>
  </command>
  <inputs>
    <param format="flowscore" name="input" type="data" label="Population score profiles from FLOCK"/>
  </inputs>
  <outputs>
    <data format="html" name="html_file" label="Cell ontology of ${input.name}">
    </data>
  </outputs>
  <tests>
    <test>
      <param name="input" value="input.flowscore"/>
      <output name="html_file" file="out.html">
        <extra_files type="file" name="flow.mfi" value="flow.mfi"/>
        <extra_files type="file" name="flow.sample" value="flow.sample"/>
        <extra_files type="file" name="m0_m0_90X90.png" value="m0_m0_90X90.png" compare="contains"/>
    </test>
  </tests>
 <help><![CDATA[
   This tool uses flowCL to find a match for each of the populations defined by FLOCK.
   
.. class:: warningmark

here some sort of reminder that trusting data from a software might not be the best way to go necessarily, and that it would be wise oh so wise to still look at the data to make sure that the scores from FLOCK mean what you think they mean.

-----

**Input**

This tool reads in the population score profiles from FLOCK. 

.. class:: warningmark

**The marker names need to be in the cell ontology for this to work**

**Output**

The output is a page that allows visualization of the data. 

-----

**Example**

*Input*

*Population profile file*::

   Population Marker1 Marker2 Marker3
   1          1      3      2
   2          1      3      4
   3          2      2      3
   4          1      3      2


*Output*

The CL terms hyperlink to their representation in the Immport Cell Ontology browser. The full flowCL run summary is accessible by clicking on the phenotype.

.. image:: ../../static/images/flowtools/profileCL.png

.. image:: ../../static/images/flowtools/popprofiles.png
  ]]>
  </help>
  <citations>
    <citation type="doi">10.1093/bioinformatics/btu807</citation>
  </citations>
</tool>

