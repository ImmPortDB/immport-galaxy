<tool id="getOntology" name="Explore cell ontology" version="1.0">
  <description>given a phenotype using flowCL.</description>
  <command interpreter="python">
      getOntology.py -o "${output}" -t $__tool_directory__ -g "${graph}" -m "${marker1}" -m "${type1}"
      #for $mrkrs in $Markers
        -m "${mrkrs.markername}"
        -m "${mrkrs.markertype}"
      #end for
  </command>
  <inputs>
    <param name="marker1" type="text" label="First marker"/>
    <param name="type1" type="select" label="First marker type">
      <option value="+">+</option>
      <option value="-">-</option>
      <option value="lo">lo</option>
      <option value="lo">low</option>
      <option value="lo">dim</option>
      <option value="lo">--</option>
      <option value="hi">hi</option>
      <option value="hi">high</option>
      <option value="hi">bri</option>
      <option value="hi">bright</option>
      <option value="hi">++</option>
    </param>
    <repeat name="Markers" title="Marker">
      <param name="markername" type="text" label="Add marker"/>
      <param name="markertype" type="select" label="Marker type">
        <option value="+">+</option>
        <option value="-">-</option>
        <option value="lo">lo</option>
        <option value="lo">low</option>
        <option value="lo">dim</option>
        <option value="lo">--</option>
        <option value="hi">hi</option>
        <option value="hi">high</option>
        <option value="hi">bri</option>
        <option value="hi">bright</option>
        <option value="hi">++</option>
      </param>
    </repeat>
  </inputs>
  <outputs>
    <data format="txt" name="output" label="flowCL run"/>
    <data format="pdf" name="graph" label="Graphical representation of flowCL run"/>
  </outputs>
  <stdio>
    <exit_code range="2" level="fatal" description="There was a problem running flowCL. You might want to check your marker names - See stderr for more details." />
    <exit_code range="3:" level="fatal" description="See stderr for more details." />
  </stdio>
 <help>
   This tool uses flowCL to find the most likely match to a given set a markers.
   
-----

**Input**

Type in the marker names and select the expression level in the drop-down menu.

**Output**

A summary of the ouptut of flowCL is captured in a txt file. For more details, please refer to the flowCL documentation.

**Graphical output**

FlowCL generates a plot for the most likely matches to ontology.

-----

**Example**

*Output text file*::

   Short marker names    "CD3-CD19-CD14+CD16+"                                                  
   Ontology marker names "CD3 epsilon, CD19 molecule, CD14 molecule, low affinity"              
                         "immunoglobulin gamma Fc region receptor III"                          
   Experiment markers    "CD3,CD19,CD14,CD16"                                                   
   Ontology exper. names "CD3 epsilon, CD19 molecule, CD14 molecule, low affinity"              
                         "immunoglobulin gamma Fc region receptor III"                          
   Successful Match?     "No"                                                                   
   Marker ID             "1) PR_000001889, PR_000001483, PR_000001020, PR_000001002 2)"         
                         "PR_000001889, PR_000001483, PR_000001020, PR_000001002 3)"            
                         "PR_000001889, PR_000001483, PR_000001020, PR_000001002"               
   Marker Label          "1) CD14 molecule, low affinity immunoglobulin gamma Fc region"        
                         "receptor III, CD3 epsilon, CD19 molecule 2) CD14 molecule, low"       
                         "affinity immunoglobulin gamma Fc region receptor III, CD3 epsilon,"   
                         "CD19 molecule 3) CD14 molecule, low affinity immunoglobulin gamma Fc" 
                         "region receptor III, CD3 epsilon, CD19 molecule"                      
   Marker Key            "1) { } CD19-, CD3-, CD14+, CD16+ ( ) [ membrane-spanning 4-domains"   
                         "subfamily A member 1-, C-C chemokine receptor type 2- ] 2) { } CD19-,"
                         "CD3-, CD14+, CD16+ ( ) [ membrane-spanning 4-domains subfamily A"     
                         "member 1-, C-C chemokine receptor type 2- ] 3) { } CD19-, CD3-,"      
                         "CD14+, CD16+ ( ) [ C-C chemokine receptor type 2-, membrane-spanning" 
                         "4-domains subfamily A member 1-, CX3C chemokine receptor 1hi ]"       
   Score (Out of 1)      "1) 0.667 2) 0.667 3) 0.571"                                           
   Cell ID               "1) CL_0001055 2) CL_0002397 3) CL_0002396"                            
   Cell Label            "1) CD14-positive, CD16-low monocyte 2) CD14-positive, CD16-positive"  
                         "monocyte 3) CD14-low, CD16-positive monocyte"                         

*Graphical output*

.. image:: ../../static/images/flowtools/flowcl.png

 </help>
 <citations>
   <citation type="doi">10.1093/bioinformatics/btu807</citation>
 </citations>
</tool>

