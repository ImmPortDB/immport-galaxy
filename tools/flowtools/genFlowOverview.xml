<tool id="genFlowOverview" name="Generate overview information" version="1.0">
  <description>of FLOCK flow analysis</description>
  <command interpreter="python">genFlowOverview.py -i $input -o $html_file -M $mfi -d $html_file.files_path -t $__tool_directory__</command>
  <inputs>
    <param format="flowclr" name="input" type="data" label="Flow Result File"/>
    <param name="mfi" type="select" label="Calculate centroids using:">
        <option value="mfi" selected="true">Mean Fluorescence Intensity</option>
        <option value="mdfi">Median Fluorescence Intensity</option>
        <option value="gmfi">Geometric Mean Fluorescence Intensity</option>
    </param>
  </inputs>
  <outputs>
    <data format="html" name="html_file" label="Overview of ${input.name}">
    </data>
  </outputs>

 <help>
   This tool generates an overview of the flow analysis results.
   
-----

**Input**

This tool can read in the output of FLOCK or of CrossSample (a tab-separated file containing the markers fluorescence intensities for each event, as well as the population or cell type they were attributed to)

**Output**

The output is a page with multiple tabs that allows visualization of the data. 

.. class: warningmark

The FLOCK output is proportionally downsampled to 20K events for the visualization.

-----

**Example**

*Input* - fluorescence intensities per marker and population ID per event::

   Marker1 Marker2 Marker3 Population
   33      47      11      1
   31      64      11      6
   21      62      99      2
   14      34      60      7

*Output*

Summary of the data:

The comment field of this table is editable, and can be used to name the populations. The edited values are used to populate the legends of the other graphs. The columns are re-orderable. The 'col visibility' button allows to choose which columns to display. 'CSV', 'PDF' and 'Copy' respectively allow to download a comma-separated values file, a pdf version or to copy to your clipboard in a tab-separated format the current view of the table.

.. image:: ../../static/images/flowtools/summary.png

.. image:: ../../static/images/flowtools/edit_summary.png


Scatterplots overview:

.. image:: ../../static/images/flowtools/overview.png

2D Scatterplot: 

The user can choose which populations and markers to display. The Plotly toolbar allows more control over the display of the graph. There is an option to save the plot as a png file.

.. image:: ../../static/images/flowtools/scatter2D.png

3D Scatterplot: 

The user can choose which populations and markers to display. The Plotly toolbar allows more control over the display of the graph. There is an option to save the plot as a png file.

.. image:: ../../static/images/flowtools/scatter3D.png

Parallel Coordinates. 

The user can reorder the markers, and choose which populations to display either by selecting them in the legends via checkboxes or by selecting them on the graph. Data selected for display is shown in the table below the graph. Mousing over a line in that table highlights the corresponding line on the graph. The 'col visibility' button allows to choose which columns to display. 'CSV', 'PDF' and 'Copy' respectively allow to download a comma-separated values file, a pdf version or to copy to your clipboard in a tab-separated format the current view of the table.

.. image:: ../../static/images/flowtools/pcflock.png

 </help>
</tool>

